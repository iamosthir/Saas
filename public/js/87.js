/*! For license information please see 87.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[87],{8087:(t,e,a)=>{a.r(e),a.d(e,{default:()=>d});function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(){n=function(){return t};var t={},e=Object.prototype,a=e.hasOwnProperty,o=Object.defineProperty||function(t,e,a){t[e]=a.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,a){return t[e]=a}}function d(t,e,a,r){var n=e&&e.prototype instanceof f?e:f,s=Object.create(n.prototype),i=new O(r||[]);return o(s,"_invoke",{value:x(t,a,i)}),s}function v(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var p={};function f(){}function _(){}function m(){}var h={};u(h,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(j([])));b&&b!==e&&a.call(b,i)&&(h=b);var y=m.prototype=f.prototype=Object.create(h);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,s,i,c){var l=v(t[o],t,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(d).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,c)}))}c(l.arg)}var s;o(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return s=s?s.then(r,r):r()}})}function x(t,e,a){var r="suspendedStart";return function(n,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw o;return P()}for(a.method=n,a.arg=o;;){var s=a.delegate;if(s){var i=B(s,a);if(i){if(i===p)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===r)throw r="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r="executing";var c=v(t,e,a);if("normal"===c.type){if(r=a.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r="completed",a.method="throw",a.arg=c.arg)}}}function B(t,e){var a=e.method,r=t.iterator[a];if(void 0===r)return e.delegate=null,"throw"===a&&t.iterator.return&&(e.method="return",e.arg=void 0,B(t,e),"throw"===e.method)||"return"!==a&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+a+"' method")),p;var n=v(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,p;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function j(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(a.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return _.prototype=m,o(y,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:_,configurable:!0}),_.displayName=u(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,l,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},C(w.prototype),u(w.prototype,c,(function(){return this})),t.AsyncIterator=w,t.async=function(e,a,r,n,o){void 0===o&&(o=Promise);var s=new w(d(e,a,r,n),o);return t.isGeneratorFunction(a)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},C(y),u(y,l,"Generator"),u(y,i,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),a=[];for(var r in e)a.push(r);return a.reverse(),function t(){for(;a.length;){var r=a.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=j,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(a,r){return s.type="throw",s.arg=t,e.next=a,r&&(e.method="next",e.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var i=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),L(a),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var r=a.completion;if("throw"===r.type){var n=r.arg;L(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:j(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=void 0),p}},t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function i(t,e,a){return(e=function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var n=a.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function c(t,e,a,r,n,o,s){try{var i=t[o](s),c=i.value}catch(t){return void a(t)}i.done?e(c):Promise.resolve(c).then(r,n)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var o=t.apply(e,a);function s(t){c(o,r,n,s,i,"next",t)}function i(t){c(o,r,n,s,i,"throw",t)}s(void 0)}))}}const u={name:"ProductionList",data:function(){return{loading:!1,batches:[],filters:{status:"",date_from:"",date_to:""},pagination:{total:0,per_page:20,current_page:1,last_page:1},selectedBatch:null,completeForm:{actual_quantity:"",actual_ingredients:{}},completing:!1}},methods:{fetchBatches:function(){var t=arguments,e=this;return l(n().mark((function a(){var r,o,i;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.length>0&&void 0!==t[0]?t[0]:1,e.loading=!0,a.prev=2,o=s({page:r,per_page:e.pagination.per_page},e.filters),a.next=6,axios.get("/dashboard/api/manufacturing/batches",{params:o});case 6:i=a.sent,e.batches=i.data.data,e.pagination=i.data.pagination,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(2),toastr.error("فشل تحميل دفعات الإنتاج");case 14:return a.prev=14,e.loading=!1,a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,11,14,17]])})))()},goToPage:function(t){t>=1&&t<=this.pagination.last_page&&this.fetchBatches(t)},resetFilters:function(){this.filters={status:"",date_from:"",date_to:""},this.fetchBatches()},getStatusColor:function(t){return{draft:"secondary",in_progress:"primary",completed:"success",cancelled:"danger"}[t]||"secondary"},formatStatus:function(t){return t.replace("_"," ").replace(/\b\w/g,(function(t){return t.toUpperCase()}))},formatDate:function(t){return new Date(t).toLocaleDateString()},formatCurrency:function(t){return parseFloat(t||0).toLocaleString("en-US",{style:"currency",currency:"USD"})},startBatch:function(t){var e=this;return l(n().mark((function a(){var r,o;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,swal.fire({title:"بدء الإنتاج؟",text:"سيتم وضع علامة على الدفعة كقيد التنفيذ.",icon:"question",showCancelButton:!0,confirmButtonText:"ابدأ",cancelButtonText:"إلغاء"});case 2:if(!a.sent.isConfirmed){a.next=14;break}return a.prev=4,a.next=7,axios.post("/dashboard/api/manufacturing/batches/".concat(t.id,"/start"));case 7:toastr.success("تم بدء الإنتاج"),e.fetchBatches(e.pagination.current_page),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(4),toastr.error((null===(r=a.t0.response)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.message)||"فشل بدء الإنتاج");case 14:case"end":return a.stop()}}),a,null,[[4,11]])})))()},openCompleteModal:function(t){this.selectedBatch=t,this.completeForm={actual_quantity:t.planned_quantity,actual_ingredients:{}},$("#completeModal").modal("show")},submitComplete:function(){var t=this;return l(n().mark((function e(){var a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.completeForm.actual_quantity){e.next=3;break}return toastr.error("الرجاء إدخال الكمية الفعلية"),e.abrupt("return");case 3:return t.completing=!0,e.prev=4,e.next=7,axios.post("/dashboard/api/manufacturing/batches/".concat(t.selectedBatch.id,"/complete"),t.completeForm);case 7:toastr.success("تم إكمال الإنتاج"),$("#completeModal").modal("hide"),t.fetchBatches(t.pagination.current_page),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),toastr.error((null===(a=e.t0.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"فشل إكمال الإنتاج");case 15:return e.prev=15,t.completing=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,12,15,18]])})))()},viewDetails:function(t){this.selectedBatch=t,$("#detailsModal").modal("show")},cancelBatch:function(t){var e=this;return l(n().mark((function a(){var r,o,s;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,swal.fire({title:"إلغاء الإنتاج؟",text:"هل أنت متأكد من إلغاء هذه الدفعة؟",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",confirmButtonText:"نعم، ألغها",cancelButtonText:"إلغاء",input:"text",inputLabel:"السبب (اختياري)"});case 2:if(!(r=a.sent).isConfirmed){a.next=14;break}return a.prev=4,a.next=7,axios.post("/dashboard/api/manufacturing/batches/".concat(t.id,"/cancel"),{reason:r.value});case 7:toastr.success("تم إلغاء الإنتاج"),e.fetchBatches(e.pagination.current_page),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(4),toastr.error((null===(o=a.t0.response)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.message)||"فشل الإلغاء");case 14:case"end":return a.stop()}}),a,null,[[4,11]])})))()}},mounted:function(){this.fetchBatches()}};const d=(0,a(1900).Z)(u,(function(){var t,e,a,r=this,n=r._self._c;return n("div",{staticClass:"production-list"},[n("div",{staticClass:"d-flex justify-content-between align-items-center mb-4"},[r._m(0),r._v(" "),n("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"manufacturing.production.create"}}},[n("i",{staticClass:"fas fa-plus me-1"}),r._v(" إنتاج جديد\n    ")])],1),r._v(" "),n("div",{staticClass:"card mb-4"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"row g-3"},[n("div",{staticClass:"col-md-3"},[n("select",{directives:[{name:"model",rawName:"v-model",value:r.filters.status,expression:"filters.status"}],staticClass:"form-select",on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));r.$set(r.filters,"status",t.target.multiple?e:e[0])},r.fetchBatches]}},[n("option",{attrs:{value:""}},[r._v("جميع الحالات")]),r._v(" "),n("option",{attrs:{value:"draft"}},[r._v("مسودة")]),r._v(" "),n("option",{attrs:{value:"in_progress"}},[r._v("قيد التنفيذ")]),r._v(" "),n("option",{attrs:{value:"completed"}},[r._v("مكتمل")]),r._v(" "),n("option",{attrs:{value:"cancelled"}},[r._v("ملغي")])])]),r._v(" "),n("div",{staticClass:"col-md-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:r.filters.date_from,expression:"filters.date_from"}],staticClass:"form-control",attrs:{type:"date",placeholder:"من تاريخ"},domProps:{value:r.filters.date_from},on:{change:r.fetchBatches,input:function(t){t.target.composing||r.$set(r.filters,"date_from",t.target.value)}}})]),r._v(" "),n("div",{staticClass:"col-md-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:r.filters.date_to,expression:"filters.date_to"}],staticClass:"form-control",attrs:{type:"date",placeholder:"إلى تاريخ"},domProps:{value:r.filters.date_to},on:{change:r.fetchBatches,input:function(t){t.target.composing||r.$set(r.filters,"date_to",t.target.value)}}})]),r._v(" "),n("div",{staticClass:"col-md-3"},[n("button",{staticClass:"btn btn-outline-secondary w-100",on:{click:r.resetFilters}},[n("i",{staticClass:"fas fa-redo me-1"}),r._v(" إعادة تعيين\n          ")])])])])]),r._v(" "),n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-hover"},[r._m(1),r._v(" "),r.loading?n("tbody",[r._m(2)]):n("tbody",[r._l(r.batches,(function(t){var e,a;return n("tr",{key:t.id},[n("td",[n("strong",[r._v(r._s(t.batch_number))])]),r._v(" "),n("td",[r._v("\n                "+r._s(null===(e=t.product)||void 0===e?void 0:e.name)+"\n                "),t.product_variation?n("span",{staticClass:"text-muted"},[r._v("\n                  ("+r._s(t.product_variation.var_name)+")\n                ")]):r._e()]),r._v(" "),n("td",[r._v(r._s(null===(a=t.recipe)||void 0===a?void 0:a.name))]),r._v(" "),n("td",[r._v(r._s(r.formatDate(t.production_date)))]),r._v(" "),n("td",[r._v(r._s(t.planned_quantity))]),r._v(" "),n("td",[r._v(r._s(t.actual_quantity||"-"))]),r._v(" "),n("td",[r._v(r._s(r.formatCurrency(t.total_cost)))]),r._v(" "),n("td",[n("span",{class:"badge bg-"+r.getStatusColor(t.status)},[r._v("\n                  "+r._s(r.formatStatus(t.status))+"\n                ")])]),r._v(" "),n("td",[n("div",{staticClass:"btn-group btn-group-sm"},["draft"===t.status?n("button",{staticClass:"btn btn-outline-primary",attrs:{title:"بدء الإنتاج"},on:{click:function(e){return r.startBatch(t)}}},[n("i",{staticClass:"fas fa-play"})]):r._e(),r._v(" "),["draft","in_progress"].includes(t.status)?n("button",{staticClass:"btn btn-outline-success",attrs:{title:"إكمال"},on:{click:function(e){return r.openCompleteModal(t)}}},[n("i",{staticClass:"fas fa-check"})]):r._e(),r._v(" "),n("button",{staticClass:"btn btn-outline-info",attrs:{title:"عرض التفاصيل"},on:{click:function(e){return r.viewDetails(t)}}},[n("i",{staticClass:"fas fa-eye"})]),r._v(" "),["draft","in_progress"].includes(t.status)?n("button",{staticClass:"btn btn-outline-danger",attrs:{title:"إلغاء"},on:{click:function(e){return r.cancelBatch(t)}}},[n("i",{staticClass:"fas fa-times"})]):r._e()])])])})),r._v(" "),0===r.batches.length?n("tr",[n("td",{staticClass:"text-center py-4 text-muted",attrs:{colspan:"9"}},[r._v("\n                لم يتم العثور على دفعات إنتاج. "),n("router-link",{attrs:{to:{name:"manufacturing.production.create"}}},[r._v("ابدأ إنتاجك الأول")])],1)]):r._e()],2)])]),r._v(" "),r.pagination.total>0?n("div",{staticClass:"d-flex justify-content-between align-items-center mt-3"},[n("div",{staticClass:"text-muted"},[r._v("\n          عرض "+r._s((r.pagination.current_page-1)*r.pagination.per_page+1)+" - "+r._s(Math.min(r.pagination.current_page*r.pagination.per_page,r.pagination.total))+" من "+r._s(r.pagination.total)+"\n        ")]),r._v(" "),n("nav",[n("ul",{staticClass:"pagination pagination-sm mb-0"},[n("li",{staticClass:"page-item",class:{disabled:1===r.pagination.current_page}},[n("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),r.goToPage(r.pagination.current_page-1)}}},[r._v("السابق")])]),r._v(" "),n("li",{staticClass:"page-item",class:{disabled:r.pagination.current_page===r.pagination.last_page}},[n("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),r.goToPage(r.pagination.current_page+1)}}},[r._v("التالي")])])])])]):r._e()])]),r._v(" "),n("div",{staticClass:"modal fade",attrs:{id:"completeModal",tabindex:"-1"}},[n("div",{staticClass:"modal-dialog modal-lg"},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title"},[r._v("إكمال الإنتاج: "+r._s(null===(t=r.selectedBatch)||void 0===t?void 0:t.batch_number))]),r._v(" "),n("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal"}})]),r._v(" "),r.selectedBatch?n("div",{staticClass:"modal-body"},[n("div",{staticClass:"mb-3"},[r._m(3),r._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:r.completeForm.actual_quantity,expression:"completeForm.actual_quantity"}],staticClass:"form-control",attrs:{type:"number",min:"0",step:"0.01"},domProps:{value:r.completeForm.actual_quantity},on:{input:function(t){t.target.composing||r.$set(r.completeForm,"actual_quantity",t.target.value)}}}),r._v(" "),n("small",{staticClass:"text-muted"},[r._v("المخطط: "+r._s(r.selectedBatch.planned_quantity))])]),r._v(" "),n("h6",{staticClass:"mb-3"},[r._v("الاستخدام الفعلي للمكونات")]),r._v(" "),n("p",{staticClass:"text-muted small"},[r._v("اترك فارغاً لاستخدام الكميات المطلوبة")]),r._v(" "),n("table",{staticClass:"table table-sm"},[r._m(4),r._v(" "),n("tbody",r._l(r.selectedBatch.ingredients,(function(t){var e,a;return n("tr",{key:t.id},[n("td",[r._v(r._s(null===(e=t.raw_material)||void 0===e?void 0:e.name))]),r._v(" "),n("td",[r._v(r._s(t.required_quantity)+" "+r._s(null===(a=t.unit)||void 0===a?void 0:a.symbol))]),r._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:r.completeForm.actual_ingredients[t.raw_material_id],expression:"completeForm.actual_ingredients[ing.raw_material_id]"}],staticClass:"form-control form-control-sm",attrs:{type:"number",min:"0",step:"0.0001",placeholder:t.required_quantity},domProps:{value:r.completeForm.actual_ingredients[t.raw_material_id]},on:{input:function(e){e.target.composing||r.$set(r.completeForm.actual_ingredients,t.raw_material_id,e.target.value)}}})])])})),0)])]):r._e(),r._v(" "),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-bs-dismiss":"modal"}},[r._v("إلغاء")]),r._v(" "),n("button",{staticClass:"btn btn-success",attrs:{type:"button",disabled:r.completing},on:{click:r.submitComplete}},[r.completing?n("span",{staticClass:"spinner-border spinner-border-sm me-1"}):r._e(),r._v("\n            إكمال الإنتاج\n          ")])])])])]),r._v(" "),n("div",{staticClass:"modal fade",attrs:{id:"detailsModal",tabindex:"-1"}},[n("div",{staticClass:"modal-dialog modal-lg"},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title"},[r._v("الدفعة: "+r._s(null===(e=r.selectedBatch)||void 0===e?void 0:e.batch_number))]),r._v(" "),n("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal"}})]),r._v(" "),r.selectedBatch?n("div",{staticClass:"modal-body"},[n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-md-4"},[n("strong",[r._v("المنتج:")]),n("br"),r._v("\n              "+r._s(null===(a=r.selectedBatch.product)||void 0===a?void 0:a.name)+"\n            ")]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("الحالة:")]),n("br"),r._v(" "),n("span",{class:"badge bg-"+r.getStatusColor(r.selectedBatch.status)},[r._v("\n                "+r._s(r.formatStatus(r.selectedBatch.status))+"\n              ")])]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("تاريخ الإنتاج:")]),n("br"),r._v("\n              "+r._s(r.formatDate(r.selectedBatch.production_date))+"\n            ")])]),r._v(" "),n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-md-4"},[n("strong",[r._v("الكمية المخططة:")]),n("br"),r._v("\n              "+r._s(r.selectedBatch.planned_quantity)+"\n            ")]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("الكمية الفعلية:")]),n("br"),r._v("\n              "+r._s(r.selectedBatch.actual_quantity||"-")+"\n            ")]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("تكلفة الوحدة:")]),n("br"),r._v("\n              "+r._s(r.formatCurrency(r.selectedBatch.unit_cost))+"\n            ")])]),r._v(" "),n("h6",{staticClass:"mt-4 mb-3"},[r._v("تفصيل التكاليف")]),r._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("strong",[r._v("تكلفة المواد:")]),r._v(" "+r._s(r.formatCurrency(r.selectedBatch.material_cost))+"\n            ")]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("تكلفة العمالة:")]),r._v(" "+r._s(r.formatCurrency(r.selectedBatch.labor_cost))+"\n            ")]),r._v(" "),n("div",{staticClass:"col-md-4"},[n("strong",[r._v("التكاليف الإضافية:")]),r._v(" "+r._s(r.formatCurrency(r.selectedBatch.overhead_cost))+"\n            ")])]),r._v(" "),n("div",{staticClass:"mt-2"},[n("strong",[r._v("التكلفة الإجمالية:")]),r._v(" "),n("span",{staticClass:"text-primary fs-5"},[r._v(r._s(r.formatCurrency(r.selectedBatch.total_cost)))])]),r._v(" "),n("h6",{staticClass:"mt-4 mb-3"},[r._v("المكونات المستخدمة")]),r._v(" "),n("table",{staticClass:"table table-sm"},[r._m(5),r._v(" "),n("tbody",r._l(r.selectedBatch.ingredients,(function(t){var e,a,o;return n("tr",{key:t.id},[n("td",[r._v(r._s(null===(e=t.raw_material)||void 0===e?void 0:e.name))]),r._v(" "),n("td",[r._v(r._s(t.required_quantity)+" "+r._s(null===(a=t.unit)||void 0===a?void 0:a.symbol))]),r._v(" "),n("td",[r._v(r._s(t.actual_quantity||"-")+" "+r._s(null===(o=t.unit)||void 0===o?void 0:o.symbol))]),r._v(" "),n("td",[r._v(r._s(r.formatCurrency(t.total_cost)))])])})),0)]),r._v(" "),r.selectedBatch.notes?n("div",{staticClass:"mt-3"},[n("h6",[r._v("ملاحظات")]),r._v(" "),n("p",{staticClass:"mb-0"},[r._v(r._s(r.selectedBatch.notes))])]):r._e()]):r._e()])])])])}),[function(){var t=this,e=t._self._c;return e("div",[e("h4",{staticClass:"mb-1"},[t._v("دفعات الإنتاج")]),t._v(" "),e("p",{staticClass:"text-muted mb-0"},[t._v("إدارة وتتبع عمليات الإنتاج الخاصة بك")])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("رقم الدفعة")]),t._v(" "),e("th",[t._v("المنتج")]),t._v(" "),e("th",[t._v("الوصفة")]),t._v(" "),e("th",[t._v("التاريخ")]),t._v(" "),e("th",[t._v("المخطط")]),t._v(" "),e("th",[t._v("الفعلي")]),t._v(" "),e("th",[t._v("التكلفة الإجمالية")]),t._v(" "),e("th",[t._v("الحالة")]),t._v(" "),e("th",[t._v("الإجراءات")])])])},function(){var t=this._self._c;return t("tr",[t("td",{staticClass:"text-center py-4",attrs:{colspan:"9"}},[t("div",{staticClass:"spinner-border text-primary"})])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"form-label"},[t._v("كمية الإنتاج الفعلية "),e("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("المادة")]),t._v(" "),e("th",[t._v("المطلوب")]),t._v(" "),e("th",[t._v("المستخدم فعلياً")])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("المادة")]),t._v(" "),e("th",[t._v("المطلوب")]),t._v(" "),e("th",[t._v("الفعلي")]),t._v(" "),e("th",[t._v("التكلفة")])])])}],!1,null,null,null).exports}}]);